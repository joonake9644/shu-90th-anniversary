# CMS 이미지/동영상 업로드 가이드

> **작성일:** 2025-12-30
> **대상:** CMS 관리자
> **목적:** 이미지 및 동영상 업로드 방법 안내

---

## 📋 목차

1. [시작하기 전에](#시작하기-전에)
2. [최초 설정 (Setup 페이지)](#최초-설정-setup-페이지)
3. [Hero Section 이미지 업로드](#hero-section-이미지-업로드)
4. [90년 명장면 이미지 업로드](#90년-명장면-이미지-업로드)
5. [미디어 라이브러리 사용](#미디어-라이브러리-사용)
6. [Firebase Storage 확인](#firebase-storage-확인)
7. [문제 해결](#문제-해결)
8. [자주 묻는 질문](#자주-묻는-질문)

---

## 🎯 시작하기 전에

### **현재 시스템 구조 이해**

```
홈페이지
    ↓ (읽기)
Firestore (데이터베이스)
    - 텍스트 콘텐츠
    - 이미지 URL ← (URL만 저장!)
    ↓ (URL로 접근)
Firebase Storage (파일 저장소)
    - 실제 이미지 파일
    - 실제 동영상 파일
```

**중요:**
- Firestore에는 **URL만** 저장됩니다
- 실제 이미지는 **Firebase Storage**에 저장됩니다
- 관리자 페이지에서 업로드하면 **자동으로 두 곳에 저장**됩니다

### **필요한 것**

1. ✅ 브라우저 (Chrome, Edge 권장)
2. ✅ Firebase 관리자 계정
3. ✅ 업로드할 이미지/동영상 파일
4. ✅ 인터넷 연결

### **파일 제한**

| 항목 | 최대 크기 | 지원 형식 |
|------|----------|---------|
| 이미지 | 50MB | JPG, PNG, GIF, WebP |
| 동영상 | 500MB | MP4, WebM, MOV |

---

## 🚀 최초 설정 (Setup 페이지)

> **⚠️ 중요:** 처음 시작할 때 한 번만 실행하면 됩니다!

### **1단계: Setup 페이지 접속**

```
http://localhost:3000/admin/login
```

**로그인:**
- 이메일: (Firebase에 등록한 관리자 이메일)
- 비밀번호: (설정한 비밀번호)

### **2단계: Setup 페이지로 이동**

로그인 후:
```
http://localhost:3000/admin/content/setup
```

### **3단계: 초기 데이터 생성**

**화면 구성:**
```
┌─────────────────────────────────────────────┐
│  CMS 초기 데이터 설정                         │
├─────────────────────────────────────────────┤
│                                             │
│  ☐ Hero Section                            │
│     메인 페이지 히어로 섹션 초기 데이터        │
│                                             │
│  ☐ Periods & Highlights                    │
│     연대별 정보 및 명장면 초기 데이터          │
│                                             │
│  ☐ Videos                                  │
│     동영상 히스토리 초기 데이터                │
│                                             │
│  [초기 데이터 생성] 버튼                     │
│                                             │
└─────────────────────────────────────────────┘
```

**실행:**
1. 필요한 섹션 체크박스 선택
2. "초기 데이터 생성" 버튼 클릭
3. 성공 메시지 확인

**결과:**
- Firestore에 기본 데이터 생성
- 기본 이미지는 Unsplash URL 사용 (임시)
- 이제 관리자 페이지에서 수정 가능

---

## 🖼️ Hero Section 이미지 업로드

> **위치:** 메인 페이지 첫 화면 배경 이미지

### **Step 1: Hero 관리 페이지 접속**

```
http://localhost:3000/admin/content/hero
```

### **Step 2: 화면 구성 이해**

```
┌────────────────────────────────────────────────────────────┐
│  HeroSection 관리          [대시보드로]                      │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌─────────────────────┐  ┌────────────────────┐         │
│  │   왼쪽: 폼 영역      │  │  오른쪽: 미리보기   │         │
│  ├─────────────────────┤  ├────────────────────┤         │
│  │                     │  │                    │         │
│  │  배경 이미지 *       │  │  [배경 이미지]      │         │
│  │  ┌───────────────┐  │  │                    │         │
│  │  │               │  │  │  THE 90TH          │         │
│  │  │  여기에 이미지 │  │  │  ANNIVERSARY       │         │
│  │  │  드래그 앤 드롭 │  │  │                    │         │
│  │  │               │  │  │  90 YEARS          │         │
│  │  │  또는 클릭     │  │  │  Of History        │         │
│  │  │               │  │  │                    │         │
│  │  └───────────────┘  │  │                    │         │
│  │                     │  │                    │         │
│  │  뱃지 텍스트        │  └────────────────────┘         │
│  │  [___________]      │                                 │
│  │                     │                                 │
│  │  메인 숫자          │                                 │
│  │  [___________]      │                                 │
│  │                     │                                 │
│  │  [저장하기]         │                                 │
│  └─────────────────────┘                                 │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

### **Step 3: 이미지 업로드 (3가지 방법)**

#### **방법 1: 드래그 앤 드롭 (가장 빠름) ⭐**

```
1. Windows 탐색기 열기 (Win+E)
2. 업로드할 이미지 찾기
3. 마우스 왼쪽 버튼으로 이미지 클릭 + 홀드
4. "배경 이미지" 점선 박스로 드래그
5. 박스 위에서 마우스 버튼 놓기 (드롭)
```

**업로드 진행:**
```
업로드 중...
┌─────────────────────────────────────┐
│  업로드 중...            87%         │
│  ████████████████░░░                │
└─────────────────────────────────────┘
```

**완료:**
```
배경 이미지 *
┌─────────────────────────────────────┐
│                                     │
│  [업로드된 이미지 미리보기]           │
│                                     │
└─────────────────────────────────────┘
     [이미지 변경]  [제거]
```

#### **방법 2: 클릭하여 업로드**

```
1. "배경 이미지" 점선 박스 클릭
2. Windows 파일 선택 창 열림
3. 이미지 선택
4. "열기" 버튼 클릭
5. 자동 업로드 시작
```

#### **방법 3: URL 직접 입력 (외부 이미지)**

```
1. "또는 URL 직접 입력" 클릭 (점선 박스 하단)
2. URL 입력 또는 붙여넣기
   예: https://example.com/image.jpg
3. 입력 완료
```

### **Step 4: 저장**

```
1. 페이지 하단 "저장하기" 버튼 클릭
2. 성공 메시지 확인:
   "저장되었습니다! 메인 페이지에서 변경사항을 확인하세요."
```

### **Step 5: 확인**

**메인 페이지 새로고침:**
```
http://localhost:3000
```

**Ctrl+F5** (강제 새로고침) → 새 배경 이미지 확인

---

## 🎨 90년 명장면 이미지 업로드

> **위치:** Highlights (명장면 90) 페이지

### **Step 1: Periods 목록 접속**

```
http://localhost:3000/admin/content/periods
```

### **Step 2: 연대 선택**

**화면:**
```
┌─────────────────────────────────────────────┐
│  Periods 관리                                │
├─────────────────────────────────────────────┤
│                                             │
│  1936-1946 태동기      [수정] [Highlights]  │
│  1947-1956 정착·재건기  [수정] [Highlights]  │
│  1957-1996 성장기      [수정] [Highlights]  │
│  1997-2016 도약기      [수정] [Highlights]  │
│  2017-현재 혁신·융합기  [수정] [Highlights]  │
│                                             │
└─────────────────────────────────────────────┘
```

**클릭:**
원하는 연대 옆의 **[Highlights 관리]** 버튼

### **Step 3: Highlight 추가**

```
┌─────────────────────────────────────────────┐
│  1936-1946 태동기 - Highlights 관리          │
├─────────────────────────────────────────────┤
│                                             │
│  [+ Highlight 추가] 버튼                    │
│                                             │
│  기존 Highlights 목록:                      │
│  - 1936: 삼육의원 개원 [수정] [삭제]         │
│  - 1940: 간호학교 설립 [수정] [삭제]         │
│                                             │
└─────────────────────────────────────────────┘
```

**클릭:** **[+ Highlight 추가]** 버튼

### **Step 4: Highlight 정보 입력**

```
┌─────────────────────────────────────────────┐
│  새 Highlight 추가                           │
├─────────────────────────────────────────────┤
│                                             │
│  순서 *                                      │
│  [1]                                        │
│                                             │
│  제목 *                                      │
│  [삼육의원 개원]                             │
│                                             │
│  연도 *                                      │
│  [1936]                                     │
│                                             │
│  썸네일 이미지 *                             │
│  ┌───────────────────────┐                 │
│  │                       │                 │
│  │  이미지 드래그 앤 드롭  │  ← 여기!       │
│  │  또는 클릭            │                 │
│  │                       │                 │
│  └───────────────────────┘                 │
│                                             │
│  설명 *                                      │
│  [진리, 사랑, 봉사의 이념으로...]            │
│                                             │
│  ☑ 공개 (체크하면 홈페이지에 표시)            │
│                                             │
│  [저장하기]                                 │
│                                             │
└─────────────────────────────────────────────┘
```

**입력:**
1. 순서, 제목, 연도 입력
2. 썸네일 이미지 드래그 앤 드롭
3. 설명 입력
4. "공개" 체크
5. "저장하기" 클릭

### **Step 5: 확인**

**홈페이지에서 확인:**
```
http://localhost:3000/highlights
```

새로고침 → 새 Highlight 확인

---

## 📁 미디어 라이브러리 사용

> **위치:** 중앙 집중식 미디어 관리

### **Step 1: 미디어 라이브러리 접속**

```
http://localhost:3000/admin/media
```

### **Step 2: 파일 업로드**

**화면:**
```
┌─────────────────────────────────────────────┐
│  미디어 라이브러리    [+ 파일 업로드] [대시보드로] │
├─────────────────────────────────────────────┤
│                                             │
│  [전체] [이미지] [비디오]                    │
│                                             │
│  ┌─────┐  ┌─────┐  ┌─────┐               │
│  │ 📷  │  │ 📷  │  │ 📷  │               │
│  │img1 │  │img2 │  │img3 │               │
│  │     │  │     │  │     │               │
│  │[URL]│  │[URL]│  │[URL]│               │
│  │[삭제]│  │[삭제]│  │[삭제]│               │
│  └─────┘  └─────┘  └─────┘               │
│                                             │
└─────────────────────────────────────────────┘
```

**업로드:**
1. 우측 상단 **[+ 파일 업로드]** 버튼 클릭
2. 파일 선택 창에서 이미지/동영상 선택
3. "열기" 클릭
4. 자동 업로드

**업로드 위치:**
- 이미지: `uploads/` 폴더
- 동영상: `videos/` 폴더

### **Step 3: URL 복사**

**방법 1: 직접 사용**
```
1. 업로드된 파일 카드 찾기
2. [URL 복사] 버튼 클릭
3. 클립보드에 복사됨
```

**방법 2: CMS에서 사용**
```
1. Hero 페이지 또는 다른 CMS 페이지 접속
2. "또는 URL 직접 입력" 클릭
3. 복사한 URL 붙여넣기
4. 저장
```

---

## 🔍 Firebase Storage 확인

### **Step 1: Firebase Console 접속**

```
https://console.firebase.google.com
```

### **Step 2: 프로젝트 선택**

```
프로젝트 목록에서:
"shu-90th-anniversary" 클릭
```

### **Step 3: Storage 메뉴**

```
왼쪽 메뉴:
Build → Storage 클릭
```

### **Step 4: 파일 확인**

**폴더 구조:**
```
Storage
├── hero/
│   └── 1735545600000_background.jpg  (Hero 배경 이미지)
├── highlights/
│   ├── 1735545601000_image1.jpg      (Highlight 썸네일)
│   └── 1735545602000_image2.jpg
├── news/
│   └── 1735545603000_thumbnail.jpg   (뉴스 썸네일)
├── events/
│   └── 1735545604000_event.jpg       (이벤트 이미지)
├── videos/
│   └── 1735545605000_video.mp4       (동영상 파일)
├── history/
│   └── 1735545606000_history.jpg     (역사 이미지)
└── uploads/
    └── 1735545607000_general.jpg     (일반 업로드)
```

**파일명 형식:**
```
{타임스탬프}_{원본파일명}
예: 1735545600000_background.jpg
```

---

## 🔧 문제 해결

### **문제 1: 로그인 페이지가 안 열림**

**증상:**
- `http://localhost:3000/admin/login` 접속 시 오류

**해결:**
```bash
# 개발 서버 실행 확인
npm run dev

# 포트 충돌 시
netstat -ano | findstr :3000
# PID 확인 후 종료
taskkill /PID {PID번호} /F
```

---

### **문제 2: 로그인이 안 됨**

**증상:**
- 이메일/비밀번호 입력 후 "인증 실패" 메시지

**해결:**
```
1. Firebase Console 접속
   https://console.firebase.google.com

2. Authentication > Users 확인
   - 사용자가 등록되어 있는지 확인
   - 없으면 "Add user" 클릭하여 추가

3. 비밀번호 재설정
   - 로그인 페이지에서 "비밀번호 찾기" 클릭
```

---

### **문제 3: 이미지 드래그 앤 드롭이 안 됨**

**증상:**
- 이미지를 드래그해도 업로드 안 됨

**해결:**
```
1. 파일 형식 확인
   - JPG, PNG, GIF, WebP만 가능
   - BMP, TIFF 등은 불가

2. 파일 크기 확인
   - 이미지: 10MB 이하
   - 너무 크면 압축 (TinyPNG.com)

3. 브라우저 확인
   - Chrome, Edge 사용 권장
   - Internet Explorer는 지원 안 됨

4. 클릭 업로드 시도
   - 점선 박스 클릭
   - 파일 선택 창에서 선택
```

---

### **문제 4: 업로드 중 "Permission denied" 오류**

**증상:**
- 브라우저 콘솔에 "Permission denied" 표시

**해결:**
```bash
# Storage rules 재배포
firebase deploy --only storage

# rules 파일 확인
# storage.rules 파일에 hero 폴더 규칙 있는지 확인
```

**storage.rules 확인:**
```javascript
match /hero/{fileName} {
  allow read: if true;
  allow write: if request.resource.size < 50 * 1024 * 1024
               && request.resource.contentType.matches('image/.*');
}
```

---

### **문제 5: 업로드 후 홈페이지에 반영 안 됨**

**증상:**
- 이미지 업로드 성공했는데 홈페이지에 안 보임

**해결:**
```
1. 강제 새로고침
   Ctrl+F5 (Windows)
   Cmd+Shift+R (Mac)

2. 브라우저 캐시 삭제
   Chrome: Ctrl+Shift+Delete
   → "캐시된 이미지 및 파일" 선택
   → "데이터 삭제"

3. 개발 서버 재시작
   터미널에서 Ctrl+C
   npm run dev

4. Firestore 데이터 확인
   Firebase Console > Firestore
   → homepage_hero 컬렉션 확인
   → backgroundImage 필드 값 확인
```

---

### **문제 6: Firebase Storage가 비어있음**

**증상:**
- Firebase Console > Storage에 파일이 없음

**원인:**
- 파일을 업로드하지 않았거나
- 업로드 실패

**해결:**
```
1. 다시 업로드 시도
   관리자 페이지에서 이미지 드래그 앤 드롭

2. 브라우저 콘솔 확인
   F12 → Console 탭
   → 에러 메시지 확인

3. 네트워크 탭 확인
   F12 → Network 탭
   → 업로드 요청 실패 여부 확인
```

---

## ❓ 자주 묻는 질문

### **Q1: 폴더가 안 보여요**

**A:** 정상입니다! 폴더는 파일을 처음 업로드할 때 자동으로 생성됩니다.

```
파일 업로드 전:
Storage (비어있음)

파일 업로드 후:
Storage
└── hero/
    └── 파일.jpg  ← 폴더 자동 생성!
```

---

### **Q2: 이미지 URL이 Unsplash로 되어있어요**

**A:** Setup 페이지에서 초기 데이터를 생성하지 않아서 Fallback 데이터를 사용 중입니다.

**해결:**
```
1. /admin/content/setup 접속
2. "Hero Section" 체크
3. "초기 데이터 생성" 클릭
4. /admin/content/hero에서 이미지 업로드
```

---

### **Q3: 여러 이미지를 한 번에 업로드할 수 있나요?**

**A:** 현재는 한 번에 하나씩만 가능합니다.

**대안:**
```
1. 미디어 라이브러리 사용
   /admin/media
   → 파일 업로드 (여러 번 반복)
   → URL 복사
   → CMS 페이지에서 URL 입력

2. 반복 업로드
   각 CMS 페이지에서 순차적으로 업로드
```

---

### **Q4: 업로드한 이미지를 삭제하려면?**

**A:** 두 가지 방법이 있습니다.

**방법 1: CMS 페이지에서**
```
1. Hero 페이지 등에서 "제거" 버튼 클릭
2. 저장
   → Firestore에서만 제거됨
   → Storage에는 파일 남아있음
```

**방법 2: 미디어 라이브러리에서**
```
1. /admin/media 접속
2. 파일 카드에서 "삭제" 버튼 클릭
   → Storage에서 완전히 삭제됨
```

---

### **Q5: 동영상은 어떻게 업로드하나요?**

**A:** 이미지와 동일한 방법입니다.

```
1. 미디어 라이브러리 사용 권장
   /admin/media
   → 파일 업로드 (MP4, WebM, MOV)
   → 최대 500MB

2. Videos CMS 페이지
   /admin/content/videos
   → 동영상 정보 입력
   → URL 필드에 업로드
```

---

### **Q6: Firebase Storage 용량은 얼마나 되나요?**

**A:** Firebase 플랜에 따라 다릅니다.

```
Spark (무료):
- 5GB 저장공간
- 1GB/일 다운로드

Blaze (종량제):
- 무제한 저장공간
- 사용한 만큼 과금
```

**용량 확인:**
```
Firebase Console > Storage
→ 상단에 사용량 표시
```

---

### **Q7: 이미지 최적화는 어떻게 하나요?**

**A:** 업로드 전 압축 권장

**권장 도구:**
```
온라인:
- TinyPNG (https://tinypng.com)
- Squoosh (https://squoosh.app)

오프라인:
- Photoshop → "웹용으로 저장"
- GIMP → 품질 85% 저장
```

**권장 사양:**
```
배경 이미지:
- 크기: 1920x1080 이상
- 용량: 500KB 이하
- 형식: JPG (사진), PNG (그래픽)

썸네일:
- 크기: 800x600 정도
- 용량: 200KB 이하
- 형식: JPG
```

---

## 📞 추가 도움말

### **문제가 계속되면:**

1. 브라우저 콘솔 확인
   - F12 → Console 탭
   - 에러 메시지 캡처

2. 네트워크 탭 확인
   - F12 → Network 탭
   - 실패한 요청 확인

3. Firebase Console 확인
   - Authentication > Users
   - Firestore > 데이터
   - Storage > 파일

4. 개발자에게 문의
   - 에러 메시지
   - 스크린샷
   - 재현 단계

---

## 📚 관련 문서

- [CMS 이미지 관리 표준 규칙](./CMS-IMAGE-MANAGEMENT-RULES.md)
- [Firebase 설정 가이드](./FIREBASE-SETUP.md)

---

**문서 버전:** 1.0
**최종 수정:** 2025-12-30
**작성자:** Claude Code Assistant
